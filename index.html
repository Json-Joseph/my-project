<!DOCTYPE html>
<html lang="en">
<head>
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
  import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js";
  import { getDatabase, ref, push, set } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-database.js";

  const firebaseConfig = {
    apiKey: "AIzaSyAodVCG4uXsHzPlkzu6J8J9tBN_9DRzjCI",
    authDomain: "graduation-joja.firebaseapp.com",
    databaseURL: "https://graduation-joja-default-rtdb.firebaseio.com",
    projectId: "graduation-joja",
    storageBucket: "graduation-joja.firebasestorage.app",
    messagingSenderId: "130643040303",
    appId: "1:130643040303:web:ec703aeea373af27780eda",
    measurementId: "G-1DX78ZMT9Y"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getDatabase(app);

  onAuthStateChanged(auth, (user) => {
    if (!user) {
      window.location.href = "login.html";
    }
  });

  // لو حابب تسجل رسالة في قاعدة البيانات
  const form = document.getElementById("messageForm");
  form.addEventListener("submit", (e) => {
    e.preventDefault();
    const name = document.getElementById("name").value || "مجهول";
    const message = document.getElementById("message").value;

    const messageRef = ref(db, "messages");
    const newMessage = push(messageRef);
    set(newMessage, {
      name: name,
      message: message
    });

    form.reset();
    document.getElementById("success").textContent = "تم الإرسال بنجاح!";
  });
</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Graduation Joja</title>
    <link rel="stylesheet" href="./style.css">
    <link rel="stylesheet" href="./bootstrap.min.css">
</head>
<body>

    <div class="container">
        <h1>اكتب رسالة تهنئة لصاحبك</h1>
    
        <form id="messageForm">
            <input type="text" id="name" placeholder="اسمك (اختياري)">
            <textarea id="message" placeholder="اكتب رسالتك هنا..." required></textarea>
            <button type="submit">إرسال</button>
        </form>

        <p id="success"></p>
    </div>

    <script type="module" src="./scripte.js"></script>
    <script src="./bootstrap.min.js"></script>
</body>
</html>